From 114b8b21cd032e49beb411b814101c560dfb49c7 Mon Sep 17 00:00:00 2001
From: Martin Weinelt <martin@darmstadt.freifunk.net>
Date: Wed, 23 Jan 2019 20:47:08 +0100
Subject: [PATCH] gluon-core: sort 010-primary-mac by target and board_name

---
 .../luasrc/lib/gluon/upgrade/010-primary-mac         | 12 +++++++-----
 1 file changed, 7 insertions(+), 5 deletions(-)

diff --git a/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac b/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
index 18ae8229..0afc23ce 100755
--- a/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
+++ b/package/gluon-core/luasrc/lib/gluon/upgrade/010-primary-mac
@@ -26,10 +26,10 @@ end
 if platform.match('ar71xx', 'generic', {'tl-wdr3600', 'tl-wdr4300',
                                         'tl-wr902ac-v1'}) then
   table.insert(try_files, 1, '/sys/class/ieee80211/phy1/macaddress')
-elseif platform.match('ramips', 'mt7621', {'dir-860l-b1'}) then
-  table.insert(try_files, 1, '/sys/class/ieee80211/phy1/macaddress')
-elseif platform.match('ar71xx', 'generic', {'unifi-outdoor-plus', 'carambola2',
-                                            'a40', 'a60', 'koala',
+elseif platform.match('ar71xx', 'generic', {'a40', 'a60',
+                                            'archer-c7-v4', 'archer-c7-v5',
+                                            'carambola2',
+                                            'koala',
                                             'mr600', 'mr600v2',
                                             'mr900', 'mr900v2',
                                             'mr1750', 'mr1750v2',
@@ -39,7 +39,7 @@ elseif platform.match('ar71xx', 'generic', {'unifi-outdoor-plus', 'carambola2',
                                             'om2p-lc',
                                             'om5p', 'om5p-an',
                                             'om5p-ac', 'om5p-acv2',
-                                            'archer-c7-v4', 'archer-c7-v5'}) then
+                                            'unifi-outdoor-plus'}) then
   table.insert(try_files, 1, '/sys/class/net/eth0/address')
 elseif platform.match('ar71xx', 'generic', {'archer-c5', 'archer-c58-v1',
                                             'archer-c59-v1', 'archer-c60-v1',
@@ -48,6 +48,8 @@ elseif platform.match('ar71xx', 'generic', {'archer-c5', 'archer-c58-v1',
 elseif platform.match('ipq40xx', nil, {'avm,fritzbox-4040',
                                        'openmesh,a42', 'openmesh,a62'}) then
   table.insert(try_files, 1, '/sys/class/net/eth0/address')
+elseif platform.match('ramips', 'mt7621', {'dir-860l-b1'}) then
+  table.insert(try_files, 1, '/sys/class/ieee80211/phy1/macaddress')
 end
 
 
-- 
2.17.1

